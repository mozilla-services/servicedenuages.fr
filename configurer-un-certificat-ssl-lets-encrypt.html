<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Service de nuages, ">

        <link rel="alternate"  href="http://www.servicedenuages.fr/feeds/all.atom.xml" type="application/atom+xml" title="Service de nuages Full Atom Feed"/>

        <title>Configurer un certificat SSL avec Let's Encrypt // Service de nuages // </title>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://www.servicedenuages.fr/theme/css/pure.css">
    <link rel="stylesheet" href="http://www.servicedenuages.fr/theme/css/pygments.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
<div class="pure-g-r" id="layout">
    <div class="sidebar sidebar-article pure-u">
        <header class="header-article">
            <hgroup>
                <h5>Publi√©</h5>
                <p title="~587 mots">~3mn de lecture üïë</p>
                <p>mer. 16 d√©cembre 2015</p>
                <a href="/">&larr; Liste des articles</a>
            </hgroup>
        </header>
    </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Configurer un certificat SSL avec Let's Encrypt</h1>
                        <p class="post-meta">                                <a class="post-category" href="http://www.servicedenuages.fr/tag/mozilla.html">mozilla</a>
                        </p>
                </header>
            </section>
            <p>Fini les certificats non s√©curis√©s et tr√®s co√ªteux !</p>
<p><img alt="Let's encrypt ‚Äî a new Certificate Authority:  free, automated, and open." src="http://www.servicedenuages.fr/images/letsencrypt-logo-horizontal.png" style="width: 1025px; height: auto; max-width: 100%;"/></p>
<p>Avec Let's Encrypt vous n'avez plus d'excuse car il vous est
maintenant possible d'obtenir un certificat SSL valide, sur tous les
navigateurs, gratuitement et sans avoir besoin d'√™tre un expert en
cryptographie.</p>
<h1>T√©l√©chargez le client sur votre ordinateur</h1>
<p>Pour commencer il vous faut installer le client letsencrypt qui va
g√©rer pour vous la g√©n√©ration de la CSR, la v√©rification aupr√®s de
letsencrypt et l'installation du certificat.</p>
<p><a href="https://letsencrypt.org/howitworks/#installing-lets-encrypt">Comme expliqu√© sur le site de letsencrypt :</a></p>
<div class="highlight"><pre><span class="nv">$ </span>git clone https://github.com/letsencrypt/letsencrypt
<span class="nv">$ </span><span class="nb">cd </span>letsencrypt
</pre></div>
<h1>Serveur d√©di√©</h1>
<p>Si vous avez la chance d'avoir un serveur d√©di√©, c'est compl√®tement
automatique et il vous suffit de lancer le script avec les bonnes options:</p>
<p>Avec Apache c'est automatique :</p>
<div class="highlight"><pre><span class="nv">$ </span>./letsencrypt-auto --apache -d example.com -d www.example.com
</pre></div>
<p>Pour les autres, la g√©n√©ration du certificat peut se faire comme cela :</p>
<div class="highlight"><pre><span class="nv">$ </span>./letsencrypt-auto certonly --webroot -w /var/www/example -d example.com -d www.example.com
</pre></div>
<p>O√π <code>/var/www/example</code> est le r√©pertoire servant les fichiers sur le domaine <code>example.com</code>.</p>
<p>Il faudra ensuite consulter la documentation de votre serveur HTTP
pour configurer votre certificat SSL.</p>
<h1>Serveur mutualis√©</h1>
<p>Comme <code>letsencrypt-auto</code> n√©cessite d'avoir les droits root, sur un
serveur mutualis√© c'est un peu moins automatique.</p>
<p>La solution propos√©e ici est de g√©n√©rer le certifiat localement en
mode manuel puis de configurer le serveur mutualis√© dans un deuxi√®me
temps.</p>
<p>Pour valider de mani√®re automatique un certificat, letsencrypt
t√©l√©charge une preuve via le nom de domaine pour lequel on demande un
certificat.</p>
<p>On va donc :</p>
<ul>
<li>Lancer le script localement ;</li>
<li>H√©berger la preuve du nom de domaine sur le serveur ;</li>
<li>Puis g√©n√©rer et configurer notre certificat SSL.</li>
</ul>
<h2>Lancer le script localement</h2>
<div class="highlight"><pre><span class="nv">$ </span>./letsencrypt-auto certonly --manual -d mondomaine.fr -d www.mondomaine.fr
</pre></div>
<h2>Mettre en ligne la preuve de possession du nom de domaine</h2>
<p>En utilisant votre client FTP vous pouvez:</p>
<ul>
<li>Cr√©ez le r√©pertoire : <code>www/.well-known/acme-challenge/</code></li>
<li>Cr√©ez le fichier dont le nom et le contenu vous est donn√©.</li>
</ul>
<p>Par exemple:</p>
<div class="highlight"><pre><span class="nv">$ </span>mkdir .well-known/acme-challenge/
<span class="nv">$ </span>cat &gt; .well-known/acme-challenge/1ni92R95ooeCPOcRhVXYSF1HXVfdS61uWMlMjQXOQns
1ni92R95ooeCPOcRhVXYSF1HXVfdS61uWMlMjQXOQns.MJvFiRCK_M0WiBPW19A7VQekVtY5sSojwa44TFcaUAw
</pre></div>
<p>V√©rifiez que vous pouvez bien acc√©der au lien qui vous est donn√© :</p>
<div class="highlight"><pre>https://www.mondomaine.com/.well-known/acme-challenge/1ni92R95ooeCPOcRhVXYSF1HXVfdS61uWMlMjQXOQns
</pre></div>
<p>Ensuite appuyez sur <em>Entr√©e</em></p>
<h2>Mettrez en ligne votre certificat</h2>
<p>Vous devez ensuite vous rendre dans l'interface de votre h√©bergeur et
renseigner le contenu des fichiers, <code>privkey.pem</code>, <code>cert.pem</code> et
<code>fullchain.pem</code> dans le champ de formulaire respectifs <code>Cl√© priv√©</code>,
<code>Certificat</code>, <code>Certificats interm√©diaires</code>, qui ont √©t√© cr√©√© pour vous
dans le r√©pertoire : <code>/etc/letsencrypt/live/mondomaine.com</code></p>
<h2>Que faire ensuite ?</h2>
<p>Votre certificat est valable pour 3 mois n'oubliez pas de vous mettre
un rappel quelques jours avant sa date d'expiration pour relancer
votre script et mettre √† jour le certificat.</p>
<p>Les fichiers <code>fullchain.pem</code> et <code>privkey.pem</code> resteront inchang√©s mais
le fichier <code>cert.pem</code> doit √™tre mis √† jour.</p>
<p>Pour se faire relancer la commande sur le m√™me ordinateur:</p>
<div class="highlight"><pre><span class="nv">$ </span>./letsencrypt-auto certonly --manual -d mondomaine.fr -d www.mondomaine.fr
</pre></div>
<p>Un √©cran s'affiche vous proposant de renouveler le certificat.</p>
<p>Suivez la proc√©dure et mettez √† jour le certificat dans l'interface de
votre h√©bergeur.</p>
<h2>Conclusion</h2>
<p>Let's Encrypt facilite vraiment la vie, plus besoin de g√©n√©rer un CSR,
plus besoin de payer, plus besoin de se creuser la t√™te pour chaque
certificat, vous pouvez mettre autant de sous domaines que vous le
souhaitez et r√©g√©nerer votre certificat jusqu'√† 5 fois par semaines si
n√©cessaire.</p>
<p>La seule chose √† faire c'est de mettre √† jour son certificat SSL tous
les 3 mois en relan√ßant la commande.</p>
<p>La proc√©dure de mise en place √©tant disponible et le client √©tant Open
Source il y a fort √† parier que les h√©bergeurs vont simplifier la
proc√©dure et la rendre sp√©cifique √† leur interface d'administration.</p>
<p>Des serveurs HTTP tels que <code>caddy</code> ont d√©j√†
<a href="https://www.youtube.com/watch?v=nk4EWHvvZtI">int√©gr√© la g√©n√©ration du certificat</a>
dans la proc√©dure d'installation de leur serveur.</p>
            <div class="hr"></div>
            <a href="#" class="go-top">Revenir au d√©but</a>
<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "servicedenuages"; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div><footer class="footer">
    <p>&copy; Service de nuages &ndash;
        D√©velopp√© avec <a href="https://github.com/PurePelicanTheme/pure">Pure Theme</a>
        et <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
</div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//piwik.notmyidea.org/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//piwik.notmyidea.org/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->
  <script src="http://www.servicedenuages.fr/theme/js/instantclick.min.js" data-no-instant></script>
  <script data-no-instant>InstantClick.init();</script>
</body>
</html>